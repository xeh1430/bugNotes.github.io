<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="路漫漫其修远兮！"><title>数据结构与算法(九)——红黑树（Red Black Tree） | xeh的学习笔记</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">数据结构与算法(九)——红黑树（Red Black Tree）</h1><a id="logo" href="/.">xeh的学习笔记</a><p class="description">将记录当成一种习惯</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">数据结构与算法(九)——红黑树（Red Black Tree）</h1><div class="post-meta">Jun 6, 2019<span> | </span><span class="category"><a href="/categories/数据结构/">数据结构</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.1k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 4</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#性质"><span class="toc-number">1.</span> <span class="toc-text">性质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#操作"><span class="toc-number">2.</span> <span class="toc-text">操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#插入"><span class="toc-number">2.1.</span> <span class="toc-text">插入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除"><span class="toc-number">2.2.</span> <span class="toc-text">删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用"><span class="toc-number">3.</span> <span class="toc-text">应用</span></a></li></ol></div></div><div class="post-content"><h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><ol>
<li>红黑树是一种自平衡<a href="https://xeh1430.github.io/text/dataStructure8" target="_blank" rel="noopener">二叉查找树（BST）</a></li>
<li>节点非黑即红，根节点是黑色的;</li>
<li>每个叶子节点都是黑色的空节点（NIL），也就是说，叶子节点不存储数据；</li>
<li>任何相邻的节点都不能同时为红色，也就是说，红色节点是被黑色节点隔开的；</li>
<li>每个节点，从该节点到达其可达叶子节点的所有路径，都包含相同数目的黑色节点；</li>
</ol>
<p><strong>自平衡二叉树</strong><br>AVL树（经典平衡树, 所有操作的最坏复杂度都是 O(log n)）、Treap、伸展树、红黑树、替罪羊树、AA树、加权平衡树等<br><strong>红黑树相对于AVL树来说，牺牲了部分平衡性以换取插入/删除操作时少量的旋转操作，整体来说性能要优于AVL树。</strong></p>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p><strong>红黑树规定，插入的节点必须是红色的。而且，二叉查找树中新插入的节点都是放在叶子节点上。</strong></p>
<p><strong>红黑树插入调整的基础操作：左右旋转和改变颜色。</strong></p>
<p><strong>情况1：</strong>插入节点位于树的根上，没有父节点。直接改变它的颜色，把它变成黑色就可以了。</p>
<p><strong>情况2：</strong>插入节点的父节点是黑色的，直接插入就行了。</p>
<p><strong>情况3：</strong>如图 N 为红，P 为红，（祖节点一定存在，且为黑，下边同理）U 也为红，这里不论 P 是 G 的左孩子，还是右孩子；不论 N 是 P 的左孩子，还是右孩子。</p>
<p>操作：把 P、U 改为黑色，G 改为红色，如 G 为根节点进行情况1操作，否则进行情况4和情况5</p>
<p>解析：N、P 都为红，违反性质4；若把 P 改为黑，符合性质4，显然右边少了一个黑节点，违反性质5；所以我们把G，U都改为相反色，符合性质5，违反性质2；将 G 作为关注点，进行下一步操作。<br><img src="https://xeh1430.github.io/img/rbt_case1.png" alt> </p>
<p><strong>情况4：</strong>N 为红，P 为红，U 为黑，P 为 G 的左孩子，N 为 P 的右孩子（或者 P 为 G 的右孩子，N 为 P 的左孩子；反正两方向相反）。</p>
<p>操作：需要进行两次变换（旋转），图中只显示了一次变换—–首先 P、N 变换，颜色不变；然后就变成了情况5的情况，按照情况4操作，即结束。<br><img src="https://xeh1430.github.io/img/rbt_case2.png" alt> </p>
<p><strong>情况5：</strong>N 为红，P 为红，U 为黑，P 为 G 的左孩子，N 为 P 的左孩子（或者 P 为 G 的右孩子，N 为 P 的左孩子；反正就是同向的）。</p>
<p>操作：P、G 变色，P、G 变换即左左单旋（或者右右单旋），结束。<br><img src="https://xeh1430.github.io/img/rbt_case3.png" alt> </p>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p><strong>如果需要删除的节点有两个儿子，那么问题可以被转化成删除另一个只有一个儿子的节点的问题，下面只讨论删除只有一个子节点的问题</strong><br><strong><font color="red">情况2-6图中，N 都是是删除了黑色节点后替换上来的子节点</font></strong></p>
<p><strong>情况1：</strong>要删除 N ，N 为根节点，直接删除，新的根节点为黑色。</p>
<p><strong>情况2：</strong>S 为红色（那么父节点 P 一定是黑，子节点一定是黑），N 是 P 的左孩子（或者 N 是 P 的右孩子）。</p>
<p>操作：以 P 为中心左旋，S 变为祖节点，P、S 颜色对调，违法性质5，未结束，接下来按情况4、情况5或情况6来处理。</p>
<p><img src="https://xeh1430.github.io/img/rbt_case4.png" alt> </p>
<p><strong>情况3：</strong>P、S 及 S 的孩子们都为黑。</p>
<p>操作：S 改为红色，接着按情况2做处理。<br><img src="https://xeh1430.github.io/img/rbt_case5.png" alt> </p>
<p><strong>情况4：</strong>P 为红（S 一定为黑），S 的孩子们都为黑。</p>
<p>操作：P变为黑，S改为红，结束。<br><img src="https://xeh1430.github.io/img/rbt_case6.png" alt> </p>
<p><strong>情况5：</strong>P 任意色，S 为黑，N 是 P 的左孩子，S 的右孩子 SR 为红，S 的左孩子任意（或者是 N 是 P 的右孩子，S 的左孩子为红，S 的右孩子任意）。</p>
<p>操作：SR（SL）改为黑，P 改为黑，S 改为 P 的颜色，p 左旋，结束。<br><img src="https://xeh1430.github.io/img/rbt_case7.png" alt> </p>
<p><strong>情况6：</strong>S 为黑，S 的左孩子 SL 为红，S 的右孩子 SR 为黑（或者 S 的右孩子为红，S 的左孩子为黑）。</p>
<p>操作：SL（或SR）改为黑，S 改为红，SL（SR）、S 右旋（左旋）；此时就回到了情况5，SL（SR）变成了黑 S，S 变成了红。<br><img src="https://xeh1430.github.io/img/rbt_case8.png" alt> </p>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p><strong>java 中的 treeMap</strong></p>
<p><strong>JDK1.8中 HashMap 在单链表冲突后采用红黑树提高查找插入的效率</strong></p>
<p><strong>参考</strong><br><a href="https://zh.wikipedia.org/wiki/红黑树" target="_blank" rel="noopener">维基百科的红黑树</a><br><a href="https://www.cnblogs.com/fornever/archive/2011/12/02/2270692.html" target="_blank" rel="noopener">博客园-红黑树</a></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/text/dataStructure10.html">数据结构与算法(十)——堆（Heap）</a><a class="next" href="/text/dataStructure8.html">数据结构与算法(八)——二叉树（Binary Tree）</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'beb8cdcc473672dd54e5',
  clientSecret: '6fb75946c9614f3b21462fb9115bdcc7c9e08072',
  repo: 'xeh1430.github.io',
  owner: 'xeh1430',
  admin: ['xeh1430'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Web-Service/">Web Service</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring-boot/">spring boot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/阅读/">阅读</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure15.html">数据结构与算法(十五)——桶、计数、基数排序</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure14.html">数据结构与算法(十四)——快排、归并排序</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure13.html">数据结构与算法(十三)——冒泡、插入、选择排序</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure12.html">数据结构与算法(十二)——排序算法</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure11.html">数据结构与算法(十一)——图（Graph）</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure10.html">数据结构与算法(十)——堆（Heap）</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure9.html">数据结构与算法(九)——红黑树（Red Black Tree）</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure8.html">数据结构与算法(八)——二叉树（Binary Tree）</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure7.html">数据结构与算法(七)——散列表（哈希表）</a></li><li class="post-list-item"><a class="post-list-link" href="/text/dataStructure6.html">数据结构与算法(六)——跳表</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://news.cnblogs.com/" title="博客园新闻" target="_blank">博客园新闻</a><ul></ul><a href="http://www.ruanyifeng.com/blog/" title="阮一峰的网络日志" target="_blank">阮一峰的网络日志</a><ul></ul><a href="https://gitee.com/explore" title="码云 开源软件" target="_blank">码云 开源软件</a><ul></ul><a href="https://github.com/" title="github" target="_blank">github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">xeh的学习笔记.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>